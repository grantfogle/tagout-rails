<div class="dashboard">
    <%= form_with url: dashboard_path, class: 'form form__inline', method: :get, scope: :filters, local: true do |f| %>
        <div class="form__field">
            <%= f.label :state, "State" %>
            <%= f.select :state,
                options_for_select([["Colorado", "CO"]], "CO"),
                {},
                { disabled: true } %>
        </div>

        <div class="form__field">
            <%= f.label :species, "Species" %>
            <%= f.select :species,
                options_for_select(HuntStat::SPECIES_OPTIONS, @filters[:species]),
                { include_blank: "All Species" } %>
        </div>

        <div class="form__field">
            <%= f.label :sex, "Sex" %>
            <%= f.select :sex,
                options_for_select(HuntStat.sex_options_for_select, @filters[:sex]),
                { include_blank: "All" } %>
        </div>

        <div class="form__field">
            <%= f.label :hunt_method, "Method" %>
            <%= f.select :hunt_method,
                options_for_select(HuntStat::METHOD_OPTIONS, @filters[:hunt_method]),
                { include_blank: "All Methods" } %>
        </div>

        <div class="form__field">
            <%= f.label :season, "Season" %>
            <%= f.select :season,
                options_for_select(HuntStat::SEASON_OPTIONS, @filters[:season]),
                { include_blank: "All Seasons" } %>
        </div>

        <div class="form__field">
            <%= f.label :resident, "Status" %>
            <%= f.select :resident,
                options_for_select(HuntStat::RESIDENT_OPTIONS, @filters[:resident]&.to_s),
                { include_blank: "All" } %>
        </div>

        <div class="form__actions">
            <%= f.submit "Filter" %>
            <%= link_to "Clear", dashboard_path %>
        </div>
    <% end %>

    <% if @draw_results.any? %>
        <div class="results-summary">
            <p>Showing <%= @showing_count %> of <%= @total_count %> hunt codes</p>
        </div>

        <div class="results-table-container">
            <table class="results-table consolidated-table">
                <thead>
                    <tr>
                        <th class="sticky-col sticky-col--code">Hunt Code</th>
                        <th class="sticky-col sticky-col--unit">Unit</th>
                        <th class="sticky-col sticky-col--status">Status</th>
                        <th class="choice-header">4th</th>
                        <th class="choice-header">3rd</th>
                        <th class="choice-header">2nd</th>
                        <% (0..@max_points).each do |pts| %>
                            <th class="point-header"><%= pts %></th>
                        <% end %>
                    </tr>
                </thead>
                <tbody id="draw-results">
                    <%= render partial: 'table_rows', locals: { draw_results: @draw_results, filters: @filters, max_points: @max_points } %>
                </tbody>
            </table>
        </div>

        <% if @has_more %>
            <div class="load-more-container" id="load-more-container">
                <%= link_to "Load More", 
                    dashboard_path(page: @next_page, filters: @filters), 
                    class: "btn btn--load-more",
                    remote: true,
                    id: "load-more-btn",
                    data: { disable_with: "Loading..." } %>
            </div>
        <% end %>
    <% else %>
        <section class="empty-state">
            <p>No draw results found. Try adjusting your filters.</p>
        </section>
    <% end %>
</div>
